@model IEnumerable<Firma.Data.Data.Sklep.Item>
@{
    ViewData["Title"] = "Sklep";
    Layout = "~/Views/Shared/_SklepLayout.cshtml";
}

<div class="row">
    <div class="col s12" style="margin-bottom: 20px;">
        <div class="input-field">
            <input id="search" type="text" class="validate">
            <label for="search">Wyszukaj</label>
            <a href="#" id="refresh-btn" class="waves-effect waves-light btn-small">Wyczyść</a>
        </div>
    </div>

    <div class="col s12" style="margin-bottom: 20px;">
        <span class="grey-text text-lighten-4" style="font-size: 18px; font-weight: bold;">Sortuj:</span>
        <a href="@Url.Action("Index", "Shop", new { sortOrder = "name_asc" })" class="grey-text text-lighten-4">Nazwa A-Z</a> |
        <a href="@Url.Action("Index", "Shop", new { sortOrder = "name_desc" })" class="grey-text text-lighten-4">Nazwa Z-A</a> |
        <a href="@Url.Action("Index", "Shop", new { sortOrder = "price_asc" })" class="grey-text text-lighten-4">Cena rosnąco</a> |
        <a href="@Url.Action("Index", "Shop", new { sortOrder = "price_desc" })" class="grey-text text-lighten-4">Cena malejąco</a>
    </div>

    <div class="card-container">
        @foreach (var towar in Model)
        {
            <div class="col s12 m6 l4">
                <div class="card" style="height: 500px;">
                    <div class="card-image" style="height: 70%; display: flex; justify-content: center; align-items: flex-start;">
                        @if (towar.Photo != null && towar.Photo.Length > 0)
                        {
                            <img src="@($"data:image/jpeg;base64,{Convert.ToBase64String(towar.Photo)}")" alt="@towar.InfoGlowne" style="max-height: 100%; max-width: 100%; object-fit: contain;">
                        }
                        else
                        {
                            <img src="" alt="@towar.InfoGlowne" style="width: 200px; height: 200px;">
                        }
                    </div>
                    <div class="card-content" style="height: 30%;">
                        <span class="card-title grey-text text-lighten-4">@towar.InfoGlowne</span>
                        <p class="light">Cena: @towar.Cena.ToString("F2") zł</p>
                        <div class="card-action" style="display: flex; justify-content: center;">
                            <a href="@Url.Action("Details", "Shop", new { id = towar.ItemId })" class="waves-effect waves-light btn">
                                Zobacz szczegóły
                                <i class="material-icons left">info</i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>


@* <script> *@
@*     $(document).ready(function () { *@
@*         var $cards = $('.card-container .card'); *@
@* *@
@*         $('#search').on('keyup', function () { *@
@*             var value = $(this).val().toLowerCase(); *@
@*             $cards.each(function () { *@
@*                 var cardText = $(this).find('.card-title, .light').text().toLowerCase(); *@
@*                 var isMatch = cardText.indexOf(value) > -1; *@
@* *@
@*                 if (isMatch) { *@
@*                     $(this).removeClass('hidden-card'); *@
@*                 } else { *@
@*                     $(this).addClass('hidden-card'); *@
@*                 } *@
@*             }); *@
@* *@
@*             rearrangeCards(); *@
@*         }); *@
@* *@
@*         $('#search').on('input', function () { *@
@*             var value = $(this).val().trim(); *@
@*             if (value === '') { *@
@*                 $cards.removeClass('hidden-card'); *@
@*                 rearrangeCards(); *@
@*             } *@
@*         }); *@
@* *@
@*         function rearrangeCards() { *@
@*             var $visibleCards = $('.card-container .card:not(.hidden-card)'); *@
@*             var numVisibleCards = $visibleCards.length; *@
@*             var numRows = Math.ceil(numVisibleCards / 3); *@
@* *@
@*             $('.card-container').empty(); *@
@* *@
@*             for (var row = 0; row < numRows; row++) { *@
@*                 var $cardRow = $('<div class="row"></div>'); *@
@* *@
@*                 for (var col = 0; col < 3; col++) { *@
@*                     var cardIndex = row * 3 + col; *@
@*                     var $card = $visibleCards.eq(cardIndex); *@
@* *@
@*                     if ($card.length) { *@
@*                         var $col = $('<div class="col s12 m6 l4"></div>'); *@
@*                         $col.append($card); *@
@*                         $cardRow.append($col); *@
@*                     } *@
@*                 } *@
@* *@
@*                 $('.card-container').append($cardRow); *@
@*             } *@
@*         } *@
@*         $('#refresh-btn').click(function () { *@
@*             location.reload(); *@
@*         }); *@
@*     }); *@
@* </script> *@
